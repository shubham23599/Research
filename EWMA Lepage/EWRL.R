# -------------------------
# 1. Enter delta grid
# -------------------------
delta <- seq(0.25, 6.00, by = 0.25)
m <- length(delta) - 1  # should be 24

# -------------------------
# 2. Enter the ARL table (tau = 1 block)
# -------------------------
ARL <- data.frame(
  WDC = c(162.61,45.70,20.12,11.70,7.91,5.86,4.61,3.75,3.13,2.66,2.29,1.99,1.75,1.55,1.39,1.27,1.19,1.12,1.08,1.05,1.03,1.01,1.01,1.00),
  AE_I  = c(122.19,34.84,17.27,11.05,8.06,6.31,5.12,4.25,3.57,3.01,2.57,2.21,1.90,1.66,1.47,1.32,1.22,1.14,1.09,1.06,1.03,1.02,1.01,1.00),
  AE_II = c(74.53,31.07,19.45,14.13,11.11,9.18,7.80,6.75,5.93,5.23,4.63,4.08,3.56,3.08,2.66,2.28,1.97,1.69,1.49,1.33,1.22,1.14,1.09,1.05),
  AC_I  = c(83.77,34.42,20.57,14.32,10.81,8.56,7.01,5.85,4.94,4.20,3.60,3.10,2.67,2.33,2.04,1.81,1.62,1.47,1.34,1.25,1.17,1.11,1.07,1.04),
  AC_II = c(83.49,34.69,21.66,15.77,12.41,10.21,8.69,7.56,6.64,5.90,5.25,4.65,4.12,3.62,3.15,2.73,2.37,2.06,1.80,1.59,1.43,1.30,1.20,1.13)
)

# -------------------------
# 3. Define EWRL function
# -------------------------
EWRL <- function(ARLc){
  mean(delta^2 * ARLc)
}

# -------------------------
# 4. Define ERARL function
# baseline = WDC
# -------------------------
ERARL <- function(ARLc, ARLb){
  mean(ARLc / ARLb)
}

# -------------------------
# 5. Compute EWRL and ERARL for all charts
# -------------------------
baseline <- ARL$WDC

results <- data.frame(
  Chart  = names(ARL),
  EWRL   = sapply(ARL, EWRL),
  ERARL  = sapply(ARL, function(col) ERARL(col, baseline))
)

print(results)
